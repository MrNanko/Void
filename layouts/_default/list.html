{{ define "main" }}
<div class="page-header">
    <h1>{{ .Title }}</h1>
    {{ if .Content }}
    <div class="page-description">
        {{ .Content }}
    </div>
    {{ else if eq .Section "" }}
    <div class="page-description">
        <p>{{ len .Pages }} content sections in total</p>
    </div>
    {{ else }}
    <div class="page-description">
        <p>{{ .Section | title }} - {{ len .Pages }} items in total</p>
    </div>
    {{ end }}
</div>

{{ if eq .Section "" }}
<!-- Homepage content sections list -->
<div class="content-sections">
    {{ range .Site.Sections }}
    {{ if ne .Section "tags" }}
    <div class="section-item">
        <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
        <p>{{ .Params.description | default (printf "%s section" .Title) }}</p>
        <div class="section-meta">
            <span class="post-count">{{ len .Pages }} items</span>
            {{ if .Pages }}
            <span class="last-updated">Last updated: {{ (.Pages.ByLastmod.Reverse | first 1).Date.Format "2006-01-02" }}</span>
            {{ end }}
        </div>
    </div>
    {{ end }}
    {{ end }}
</div>
{{ else }}
<!-- Article list for specific sections -->
<div class="post-list">
    {{ range .Paginator.Pages }}
    <article class="post-summary">
        <header class="post-header">
            <h2 class="post-title">
                <a href="{{ .Permalink }}">{{ .Title }}</a>
            </h2>
            <div class="post-meta">
                {{ if .Date }}
                <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
                {{ end }}
                {{ if .Params.tags }}
                <span class="post-tags">
                    {{ range .Params.tags }}
                    <a href="{{ "/tags/" | relURL }}{{ . | urlize }}" class="tag">#{{ . }}</a>
                    {{ end }}
                </span>
                {{ end }}
            </div>
        </header>
        
        {{ if .Summary }}
        <div class="post-summary-content">
            {{ .Summary }}
        </div>
        {{ end }}
    </article>
    {{ end }}
</div>

{{ partial "pagination.html" . }}
{{ end }}
{{ end }}